# SimpleMdWbs 記法 仕様書 Ver. 0.5 (2025-06-03) <-- バージョン更新

## 1. はじめに

### 1.1. 本仕様書の目的

本仕様書は、`simple-md-wbs` 記法を用いて記述されたWBS（Work Breakdown Structure）ファイルの構造と記法を定義します。この仕様書に従うことで、WBSファイルを一貫性のある形式で作成し、ツールによる解析や変換を容易にすることが可能になります。

### 1.2. `simple-md-wbs` 記法の概要と特徴

`simple-md-wbs` 記法は、Markdownをベースとした軽量なWBS記述記法です。

* テキスト形式のため、バージョン管理システムとの連携が容易です。
* 可読性が高く、特別な`エディタ`を必要としません。
* 特定のツールに依存せず、汎用的に利用できます。

## 2. 基本構造とルール

### 2.1. ファイルエンコーディング

`simple-md-wbs` ファイルは、**UTF-8** エンコーディングで保存してください。**UTF-8 with BOM** を推奨します。

### 2.2. 階層表現

WBSの階層構造は、Markdownの見出しとリストを用いて表現します。

* プロジェクト名（H1見出し: `# プロジェクト名`）
* 大分類（H2見出し: `## 大分類名`）
* 中分類（H3見出し: `### 中分類名`）
* 小分類（H4見出し: `#### 小分類名`）
* タスク（リストアイテム: `- タスク名` または `* タスク名`）

### 2.3. 見出しのルール

* **必須:** 各見出し行（H1, H2, H3, H4）の**直後には、必ず1行の空行を挿入してください。**
* **推奨:** 各見出し行の前にも空行を挿入することを強く推奨します。

## 3. 属性の記述方法

各カテゴリ（プロジェクト名、大分類、中分類、小分類）および各タスクは、以下の属性情報を保持できます。
**カテゴリ属性とタスク属性は、同じフィールドセットと順序を共有します。**

### 3.1. カテゴリ属性行（`%%`行）

カテゴリ（大分類、中分類、小分類）の属性は、`%%` で始まる行に記述します。

* 書式:

    ```markdown
    %% ユーザー記述ID,開始日（入力）,終了日（入力）,日数（入力）,関連タスク種別,関連タスクID,開始日（実績）,進捗率,担当者,担当組織,最終更新日,コメント
    ```

* 例:

    ```markdown
    ## 大分類A

    %% D1,2025-07-31,40,,,計画中,10%,PM田中,全体統括,2025-06-01,最重要フェーズ、リソース確保を優先
    ```

### 3.2. タスク属性（HTMLコメント内）

タスクの属性は、タスク名のリストアイテムに続くHTMLコメント内に記述します。

* 書式:

    ```markdown
    - タスク名 <!-- ユーザー記述ID,開始日（入力）,終了日（入力）,日数（入力）,関連タスク種別,関連タスクID,開始日（実績）,進捗率,担当者,担当組織,最終更新日,コメント -->
    ```

* 例:

    ```markdown
    - タスクA <!-- D1C1S1T1,2025-06-07,3,,,未着手,0,鈴木担当,要件定義チーム,2025-06-03,A部署ヒアリング準備、質問票作成、アポ取り -->
    ```

* **注意:** HTMLコメントは、タスク名のリストアイテムと同じ行に記述する必要があります。

### 3.3. 属性フィールド一覧と詳細（カテゴリ・タスク共通）

以下の表は、属性行（`%%`）およびHTMLコメント属性内で使用される属性フィールドの定義と順序を示します。

| No. | フィールド名             | 型（例）        | 必須/任意 | 説明                                                                                                | 例                                   |
|-----|--------------------------|----------------|-----------|-----------------------------------------------------------------------------------------------------|--------------------------------------|
| 1   | **ユーザー記述ID**       | String         | 必須      | アイテムを識別するID。依存関係指定に使用。ファイル内でユニーク推奨。                                   | `D1`, `D1C1S1T2`                       |
| 2   | 開始日（入力）           | String（YYYY-MM-DD）| 任意      | ExcelのS列「開始入力」に対応。                                                                        | `2025-06-01`                         |
| 3   | 終了日（入力）           | String（YYYY-MM-DD）| 任意      | ExcelのT列「終了入力」に対応。                                                                        | `2025-07-31`                         |
| 4   | 日数（入力）             | String（Integer）| 任意      | ExcelのU列「日数入力」に対応。                                                                      | `5`, `20`                            |
| 5   | 関連タスク種別           | String         | 任意      | `"先行"` または `"後続"`。                                                                              | `先行`                               |
| 6   | 関連タスクID             | String         | 任意      | 依存するタスクの「ユーザー記述ID」。現状単一指定のみ。                                                  | `D1C1S1T1`                           |
| 7   | 開始日（実績）           | String（YYYY-MM-DD）| 任意      | ExcelのZ列「開始日（実績）」に対応。                                                                  | `2025-06-05`                         |
| 8   | 進捗率                   | String         | 任意      | ExcelのX列「進捗率」に対応。パーセント表記 (例: `50%`) のみ許容。                                     | `50%`                                |
| 9   | 担当者                   | String         | 任意      | ExcelのP列(仮)「担当者」に対応。                                                                      | `PM田中`, `佐藤リーダー`                |
| 10  | 担当組織                 | String         | 任意      | ExcelのO列(仮)「担当組織」に対応。                                                                      | `全体統括`, `要件定義チーム`            |
| 11  | **最終更新日**           | **String（YYYY-MM-DD）**| **任意**  | **ExcelのQ列「最終更新（日）」に対応。ユーザーによる手入力情報、またはツールによる自動更新（将来検討）。** | **`2025-06-10`**                     |
| 12  | コメント                 | String         | 任意      | ExcelのJ列「アクションプラン」に対応。このフィールド以降の文字列すべて。カンマ (`,`) を含むことも可能。 | `これは重要なタスクです, 詳細別途`  |

## 4. 無視される行

以下の行は、ツールによって無視されます。

* 空行
* コメント行（`<!-- コメント -->`）
* 属性行で始まらない行（`%%` で始まらない行）
* リストアイテムで始まらない行（`-` または `*` で始まらない行）
* 見出しで始まらない行（`#` で始まらない行）

ユーザーは、WBSデータのブロック間に、これらの行を個人的なメモ、区切り線（`---` など）、または整形のための空行として自由に挿入できます。

## 5. 記述サンプル

以下は、`simple-md-wbs` 記法で記述されたWBSのサンプルです。

```markdown
# プロジェクトA <!-- 2.2. プロジェクト名（H1見出し）-->

<!-- 2.3. 見出しのルール: 見出しの直後には必ず1行の空行を挿入 -->

## 大分類A <!-- 2.2. 大分類（H2見出し）-->

%% D1,2025-07-31,40,,,計画中,10%,PM田中,全体統括,2025-06-01,最重要フェーズ、リソース確保を優先 <!-- 3.1. カテゴリ属性行。D1がユーザー記述ID -->

### 中分類A <!-- 2.2. 中分類（H3見出し）-->

#### 小分類A <!-- 2.2. 小分類（H4見出し）-->

- タスクA <!-- D1C1S1T1,2025-06-07,3,,,未着手,0,鈴木担当,要件定義チーム,2025-06-03,A部署ヒアリング準備、質問票作成、アポ取り --> <!-- 3.2. タスク属性。最初の要素がユーザー記述ID -->
- タスクB <!-- D1C1S1T2,2025-06-14,5,先行,D1C1S1T1,計画中,20%,山田担当,要件定義チーム,,B部署レビュー -->

## 大分類B <!-- 2.2. 大分類（H2見出し）-->

%% D2,2025-08-31,60,,,計画中,0%,PL佐藤,開発チーム,,詳細設計、実装

- タスクC <!-- D2T1,2025-07-01,10,,,未着手,0,吉田担当,開発チーム,,,詳細設計 -->
```

## 6. 改訂履歴

| バージョン | 日付       | 変更者    | 変更内容  |
|------------|------------|-----------|-----------|
| 0.5        | 2025-06-03 | IT Legacy | カテゴリ・タスク属性の順序を統一。「最終更新日」をコメント直前に配置。進捗率形式を%のみにFIX。状態属性削除。 |
| 0.4        | 2025-06-03 | IT Legacy | 「進捗率」の入力形式をパーセント表記のみに限定。「状態」属性をリストから削除。属性順序を最終化。 |
| 0.3        | 2025-06-03 | IT Legacy | 進捗率の入力形式をパーセント表記のみに限定。                 |
| 0.2        | 2025-06-02 | IT Legacy | 改訂履歴にバージョン0.2の情報を追加。                        |
| 0.1        | 2025-05-31 | IT Legacy | 初版ドラフト作成。プロトタイプの結果とここまでの議論を反映。 |
