# SimpleMdWbs 記法 仕様書 Ver. 0.2（2025-06-02）

## 1. はじめに

### 1.1. 本仕様書の目的

本仕様書は、`simple-md-wbs` 記法を用いて記述されたWBS（Work Breakdown Structure）ファイルの構造と記法を定義します。この仕様書に従うことで、WBSファイルを一貫性のある形式で作成し、ツールによる解析や変換を容易にすることが可能になります。

### 1.2. `simple-md-wbs` 記法の概要と特徴

`simple-md-wbs` 記法は、Markdownをベースとした軽量なWBS記述記法です。

* テキスト形式のため、バージョン管理システムとの連携が容易です。
* 可読性が高く、特別な`エディタ`を必要としません。
* 特定のツールに依存せず、汎用的に利用できます。

## 2. 基本構造とルール

### 2.1. ファイルエンコーディング

`simple-md-wbs` ファイルは、**UTF-8** エンコーディングで保存してください。**UTF-8 with BOM** を推奨します。

### 2.2. 階層表現

WBSの階層構造は、Markdownの見出しとリストを用いて表現します。

* プロジェクト名（H1見出し: `# プロジェクト名`）
* 大分類（H2見出し: `## 大分類名`）
* 中分類（H3見出し: `### 中分類名`）
* 小分類（H4見出し: `#### 小分類名`）
* タスク（リストアイテム: `- タスク名` または `* タスク名`）

### 2.3. 見出しのルール

* **必須:** 各見出し行（H1, H2, H3, H4）の**直後には、必ず1行の空行を挿入してください。**
* **推奨:** 各見出し行の前にも空行を挿入することを強く推奨します。

## 3. 属性の記述方法

### 3.1. カテゴリ属性行（`%%`行）

カテゴリ（大分類、中分類、小分類）の属性は、`%%` で始まる行に記述します。

* 書式:

    ```markdown
    %% ユーザー記述ID,終了日,日数,依存種別,先行タスクID,状態,進捗率,担当者,担当組織,開始日実績,コメント
    ```

* 例:

    ```markdown
    ## 大分類A

    %% D1,2025-07-31,40,,,計画中,10%,PM田中,全体統括,2025-06-01,最重要フェーズ、リソース確保を優先
    ```

### 3.2. タスク属性（HTMLコメント内）

タスクの属性は、タスク名のリストアイテムに続くHTMLコメント内に記述します。

* 書式:

    ```markdown
    - タスク名 <!-- ユーザー記述ID,終了日,日数,依存種別,先行タスクID,状態,進捗率,担当者,担当組織,開始日実績,コメント -->
    ```

* 例:

    ```markdown
    - タスクA <!-- D1C1S1T1,2025-06-07,3,,,未着手,0,鈴木担当,要件定義チーム,2025-06-03,A部署ヒアリング準備、質問票作成、アポ取り -->
    ```

* **注意:** HTMLコメントは、タスク名のリストアイテムと同じ行に記述する必要があります。

### 3.3. 属性フィールド一覧と詳細（カテゴリ・タスク共通）

以下の表は、属性行（`%%`）およびHTMLコメント属性内で使用される属性フィールドの定義と順序を示します。

| No. | フィールド名             | 型（例）| 必須/任意 | 説明                                                                                                | 例                                   |
|-----|--------------------------|----------------|-----------|-----------------------------------------------------------------------------------------------------|--------------------------------------|
| 1   | **ユーザー記述ID**       | String         | 必須      | アイテムを識別する一意の文字列。依存関係指定に使用。**ファイル内でユニークであることを強く推奨。** ツールは重複チェックを行わない。CSV出力時、このIDがそのまま使用される。 | `D1`, `D1C1S1T2`                       |
| 2   | 終了日                   | String（YYYY-MM-DD）| 任意      | YYYY-MM-DD形式の締切日。ツールは文字列として解釈し、そのままCSVに出力。Excel側で日付型として扱われることを想定。                 | `2025-07-31`                         |
| 3   | 日数                     | String（Integer）| 任意      | 所要日数。ツールは文字列として解釈し、そのままCSVに出力。ExcelのU列（日数入力）に対応し、Excel側で数値として扱われることを想定。    | `5`, `20`                            |
| 4   | 依存関係種別             | String         | 任意      | `"先行"` または `"後続"`。先行タスクとの関係を示す。それ以外の値は無視されるか、空として扱われる。CSV出力時、指定された文字列がそのまま出力される。 | `先行`                               |
| 5   | 先行タスクID             | String         | 任意      | 依存する先行タスクの「ユーザー記述ID」。**現状、単一指定のみサポート。**複数指定の動作は未定義。CSV出力時、指定されたIDがそのまま出力される。依存関係の解決はこのIDに基づいて行われる。                | `D1C1S1T1`                          |
| 6   | 状態                     | String         | 任意      | タスクやカテゴリの状態（例: `未着手`, `計画中`, `実施中`, `完了`）。CSV出力時、指定された文字列がそのまま出力される。                                     | `計画中`                             |
| 7   | 進捗率                   | String         | 任意      | パーセント表記（`50%`）または小数表記（`0.5`）を許容。ツールは文字列として解釈し、そのままCSVに出力。Excel側で数値/パーセントとして扱われることを想定。 | `50%`, `0.75`                        |
| 8   | 担当者                   | String         | 任意      | CSV出力時、指定された文字列がそのまま出力される。                                                                                                    | `PM田中`, `佐藤リーダー`                 |
| 9   | 担当組織                 | String         | 任意      | CSV出力時、指定された文字列がそのまま出力される。                                                                                                    | `全体統括`, `要件定義チーム`             |
| 10  | 開始日実績               | String（YYYY-MM-DD）| 任意      | YYYY-MM-DD形式の実際に開始した日付。ツールは文字列として解釈し、そのままCSVに出力。Excel側で日付型として扱われることを想定。       | `2025-06-01`                         |
| 11  | コメント                 | String         | 任意      | 当該アイテムに関する自由な注釈。このフィールド以降の文字列すべて。カンマ（`,`）を含むことも可能。CSV出力時、指定された文字列がそのまま出力される。        | `これは重要なタスクです, 詳細別途` |

## 4. 無視される行

以下の行は、ツールによって無視されます。

* 空行
* コメント行（`<!-- コメント -->`）
* 属性行で始まらない行（`%%` で始まらない行）
* リストアイテムで始まらない行（`-` または `*` で始まらない行）
* 見出しで始まらない行（`#` で始まらない行）

ユーザーは、WBSデータのブロック間に、これらの行を個人的なメモ、区切り線（`---` など）、または整形のための空行として自由に挿入できます。

## 5. 記述サンプル

以下は、`simple-md-wbs` 記法で記述されたWBSのサンプルです。

```markdown
# プロジェクトA <!-- 2.2. プロジェクト名（H1見出し）-->

<!-- 2.3. 見出しのルール: 見出しの直後には必ず1行の空行を挿入 -->

## 大分類A <!-- 2.2. 大分類（H2見出し）-->

%% D1,2025-07-31,40,,,計画中,10%,PM田中,全体統括,2025-06-01,最重要フェーズ、リソース確保を優先 <!-- 3.1. カテゴリ属性行。D1がユーザー記述ID -->

### 中分類A <!-- 2.2. 中分類（H3見出し）-->

#### 小分類A <!-- 2.2. 小分類（H4見出し）-->

- タスクA <!-- D1C1S1T1,2025-06-07,3,,,未着手,0,鈴木担当,要件定義チーム,2025-06-03,A部署ヒアリング準備、質問票作成、アポ取り --> <!-- 3.2. タスク属性。最初の要素がユーザー記述ID -->
- タスクB <!-- D1C1S1T2,2025-06-14,5,先行,D1C1S1T1,計画中,20%,山田担当,要件定義チーム,,B部署レビュー -->

## 大分類B <!-- 2.2. 大分類（H2見出し）-->

%% D2,2025-08-31,60,,,計画中,0%,PL佐藤,開発チーム,,詳細設計、実装

- タスクC <!-- D2T1,2025-07-01,10,,,未着手,0,吉田担当,開発チーム,,,詳細設計 -->
```

## 6. 改訂履歴

| バージョン | 日付       | 変更者    | 変更内容                                                     |
|------------|------------|-----------|--------------------------------------------------------------|
| 0.2        | 2025-06-02 | IT Legacy | 改訂履歴にバージョン0.2の情報を追加。                        |
| 0.1        | 2025-05-31 | IT Legacy | 初版ドラフト作成。プロトタイプの結果とここまでの議論を反映。 |
