PS C:\Temp\MD-WBS-Tools> .\src\powershell\Convert-SimpleMdWbsToCsv.ps1 -InputFilePath ".\samples\mdwbs_examples\sample_project_B_comprehensive_with_errors.md" -OutputCsvPath ".\tests\outputs\mdwbs_to_csv\sample_project_B_output.csv" -Verbose
VERBOSE: Starting script Convert-SimpleMdWbsToCsv.ps1
VERBOSE: Loading module from path 'C:\Temp\MD-WBS-Tools\src\powershell\Modules\MyCommonFunctions\MyCommonFunctions.psd1'.
VERBOSE: Removing the imported "Reset-WbsCounters" function.
VERBOSE: Removing the imported "Get-DecodedAndMappedAttribute" function.
VERBOSE: Removing the imported "ConvertTo-AttributeObject" function.
VERBOSE: Loading module from path 'C:\Temp\MD-WBS-Tools\src\powershell\Modules\MyCommonFunctions\MyCommonFunctions.psm1'.
VERBOSE: Importing function 'ConvertTo-AttributeObject'.
VERBOSE: Importing function 'Get-DecodedAndMappedAttribute'.
VERBOSE: Importing function 'Reset-WbsCounters'.
VERBOSE: Successfully imported module: C:\Temp\MD-WBS-Tools\src\powershell\Modules\MyCommonFunctions\MyCommonFunctions.psd1
VERBOSE: WBS counters have been reset at the beginning of the script.
VERBOSE: Successfully read file: .\samples\mdwbs_examples\sample_project_B_comprehensive_with_errors.md
VERBOSE: For H1 'プロジェクトX - 包括的テストケース', AttributeString: 'PROJ_X_FULL,2025-01-01,,200,先行,ROOT_TASK,2025-01-15,2025-12-20,10%,プロジェクト管理者,全社,15.5,プロジェクト全体の包括的テストケース。終了日(入力)は空。実績工数15.5。'
VERBOSE:   Populating H1 item from attributesObject (UserDefinedId: 'PROJ_X_FULL')
VERBOSE:     Set $item.UserDefinedId = 'PROJ_X_FULL'
VERBOSE:     Set $item.StartDateInput = '2025-01-01'
VERBOSE:     Set $item.EndDateInput = ''
VERBOSE:     Set $item.DurationInput = '200'
VERBOSE:     Set $item.DependencyType = '先行'
VERBOSE:     Set $item.PredecessorUserDefinedId = 'ROOT_TASK'
VERBOSE:     Set $item.ActualStartDate = '2025-01-15'
VERBOSE:     Set $item.ActualEndDate = '2025-12-20'
VERBOSE:     Set $item.Progress = '10%'
VERBOSE:     Set $item.Assignee = 'プロジェクト管理者'
VERBOSE:     Set $item.Organization = '全社'
VERBOSE:     Set $item.LastUpdatedDate = '15.5'
VERBOSE:     Set $item.ItemComment = 'プロジェクト全体の包括的テストケース。終了日(入力)は空。実績工数15.5。'
VERBOSE: For Task 'タスク1 (ITEM_A1_1配下): 全属性、コメントにカンマ、開始日と日数入力', AttributeString from HTML comment: 'TASK_001_ERR_PREDECESSOR,2025-02-17,,2,先行,PRE_TASK_DUMMY_NON_EXISTENT,2025-02-18,2025-02-19,100%,作業員A,チームA1,5,完了タスク、カンマ,あり。終了日(入力)は空。(先行タスクID未定義エラーテストとしてID変更、実績工数を数値に変更)'
VERBOSE:   Populating Task item from attributesObject (UserDefinedId: 'TASK_001_ERR_PREDECESSOR')
VERBOSE:     Set $item.UserDefinedId = 'TASK_001_ERR_PREDECESSOR'
VERBOSE:     Set $item.StartDateInput = '2025-02-17'
VERBOSE:     Set $item.EndDateInput = ''
VERBOSE:     Set $item.DurationInput = '2'
VERBOSE:     Set $item.DependencyType = '先行'
VERBOSE:     Set $item.PredecessorUserDefinedId = 'PRE_TASK_DUMMY_NON_EXISTENT'
VERBOSE:     Set $item.ActualStartDate = '2025-02-18'
VERBOSE:     Set $item.ActualEndDate = '2025-02-19'
VERBOSE:     Set $item.Progress = '100%'
VERBOSE:     Set $item.Assignee = '作業員A'
VERBOSE:     Set $item.Organization = 'チームA1'
VERBOSE:     Set $item.LastUpdatedDate = '5'
VERBOSE:     Set $item.ItemComment = '完了タスク、カンマ,あり。終了日(入力)は空。(先行タスクID未定義エラーテストとしてID変更、実績工数を数値に変更)'
VERBOSE: For Task 'タスク2 (ITEM_A1_1配下): 属性一部省略 (必須IDとコメントのみ)', AttributeString from HTML comment: 'TASK_002,,,,,,,,,,,,一部省略タスク、コメントあり'
VERBOSE:   Populating Task item from attributesObject (UserDefinedId: 'TASK_002')
VERBOSE:     Set $item.UserDefinedId = 'TASK_002'
VERBOSE:     Set $item.StartDateInput = ''
VERBOSE:     Set $item.EndDateInput = ''
VERBOSE:     Set $item.DurationInput = ''
VERBOSE:     Set $item.DependencyType = ''
VERBOSE:     Set $item.PredecessorUserDefinedId = ''
VERBOSE:     Set $item.ActualStartDate = ''
VERBOSE:     Set $item.ActualEndDate = ''
VERBOSE:     Set $item.Progress = ''
VERBOSE:     Set $item.Assignee = ''
VERBOSE:     Set $item.Organization = ''
VERBOSE:     Set $item.LastUpdatedDate = ''
VERBOSE:     Set $item.ItemComment = '一部省略タスク、コメントあり'
VERBOSE: For Task 'タスク3 (ITEM_A1_1配下): 正常な先行タスク指定、開始日と終了日入力', AttributeString from HTML comment: 'TASK_003,2025-02-20,2025-02-22,,先行,TASK_001_ERR_PREDECESSOR,2025-02-21,,0%,作業員B,チームA1,1,TASK_001_ERR_PREDECESSORに依存。日数(入力)は空。実績工数1。'
VERBOSE:   Populating Task item from attributesObject (UserDefinedId: 'TASK_003')
VERBOSE:     Set $item.UserDefinedId = 'TASK_003'
VERBOSE:     Set $item.StartDateInput = '2025-02-20'
VERBOSE:     Set $item.EndDateInput = '2025-02-22'
VERBOSE:     Set $item.DurationInput = ''
VERBOSE:     Set $item.DependencyType = '先行'
VERBOSE:     Set $item.PredecessorUserDefinedId = 'TASK_001_ERR_PREDECESSOR'
VERBOSE:     Set $item.ActualStartDate = '2025-02-21'
VERBOSE:     Set $item.ActualEndDate = ''
VERBOSE:     Set $item.Progress = '0%'
VERBOSE:     Set $item.Assignee = '作業員B'
VERBOSE:     Set $item.Organization = 'チームA1'
VERBOSE:     Set $item.LastUpdatedDate = '1'
VERBOSE:     Set $item.ItemComment = 'TASK_001_ERR_PREDECESSORに依存。日数(入力)は空。実績工数1。'
VERBOSE: For Task 'タスク4 (ITEM_A1_1配下): 先行タスクID不正 (エラーケース)、日数と終了日入力', AttributeString from HTML comment: 'TASK_004_ERR_PREDECESSOR_NOT_FOUND,,2025-03-05,5,先行,NON_EXISTENT_TASK_ID,,,0%,作業員C,チームA1,,存在しない先行タスクIDを指定。開始日(入力)は空。'
VERBOSE:   Populating Task item from attributesObject (UserDefinedId: 'TASK_004_ERR_PREDECESSOR_NOT_FOUND')
VERBOSE:     Set $item.UserDefinedId = 'TASK_004_ERR_PREDECESSOR_NOT_FOUND'
VERBOSE:     Set $item.StartDateInput = ''
VERBOSE:     Set $item.EndDateInput = '2025-03-05'
VERBOSE:     Set $item.DurationInput = '5'
VERBOSE:     Set $item.DependencyType = '先行'
VERBOSE:     Set $item.PredecessorUserDefinedId = 'NON_EXISTENT_TASK_ID'
VERBOSE:     Set $item.ActualStartDate = ''
VERBOSE:     Set $item.ActualEndDate = ''
VERBOSE:     Set $item.Progress = '0%'
VERBOSE:     Set $item.Assignee = '作業員C'
VERBOSE:     Set $item.Organization = 'チームA1'
VERBOSE:     Set $item.LastUpdatedDate = ''
VERBOSE:     Set $item.ItemComment = '存在しない先行タスクIDを指定。開始日(入力)は空。'
VERBOSE: For Task 'タスク5 (ITEM_A1_1配下): ユーザー記述ID重複 (エラーケース)', AttributeString from HTML comment: 'TASK_005_ID_DUPLICATE_WITH_TASK_001,2025-03-10,2025-03-12,2,,,,,0%,作業員D,チームA1,,TASK_001_ERR_PREDECESSORとID重複のテスト。このIDはTASK_001_ERR_PREDECESSORと重複させる意図。より明確なIDに変更。'
VERBOSE:   Populating Task item from attributesObject (UserDefinedId: 'TASK_005_ID_DUPLICATE_WITH_TASK_001')
VERBOSE:     Set $item.UserDefinedId = 'TASK_005_ID_DUPLICATE_WITH_TASK_001'
VERBOSE:     Set $item.StartDateInput = '2025-03-10'
VERBOSE:     Set $item.EndDateInput = '2025-03-12'
VERBOSE:     Set $item.DurationInput = '2'
VERBOSE:     Set $item.DependencyType = ''
VERBOSE:     Set $item.PredecessorUserDefinedId = ''
VERBOSE:     Set $item.ActualStartDate = ''
VERBOSE:     Set $item.ActualEndDate = ''
VERBOSE:     Set $item.Progress = '0%'
VERBOSE:     Set $item.Assignee = '作業員D'
VERBOSE:     Set $item.Organization = 'チームA1'
VERBOSE:     Set $item.LastUpdatedDate = ''
VERBOSE:     Set $item.ItemComment = 'TASK_001_ERR_PREDECESSORとID重複のテスト。このIDはTASK_001_ERR_PREDECESSORと重複させる意図。より明確なIDに変更。'
VERBOSE: For Task 'タスク6 (ITEM_A1_1配下): 属性フィールド数不足 (エラーケース、9フィールド、期待は13)、開始日と日数入力', AttributeString from HTML comment: 'TASK_006_ERR_FIELD_COUNT_LESS,2025-03-15,,5,先行,TASK_003,2025-03-16,50%,作業員E --> <!-- コメントを実際の9フィールドに合わせるか、データを10フィールドに調整'
VERBOSE:   Populating Task item from attributesObject (UserDefinedId: 'TASK_006_ERR_FIELD_COUNT_LESS')
VERBOSE:     Set $item.UserDefinedId = 'TASK_006_ERR_FIELD_COUNT_LESS'
VERBOSE:     Set $item.StartDateInput = '2025-03-15'
VERBOSE:     Set $item.EndDateInput = ''
VERBOSE:     Set $item.DurationInput = '5'
VERBOSE:     Set $item.DependencyType = '先行'
VERBOSE:     Set $item.PredecessorUserDefinedId = 'TASK_003'
VERBOSE:     Set $item.ActualStartDate = '2025-03-16'
VERBOSE:     Set $item.ActualEndDate = '50%'
VERBOSE:     Set $item.Progress = '作業員E --> <!-- コメントを実際の9フィールドに合わせるか、データを10フィールドに調整'
VERBOSE:     Set $item.Assignee = ''
VERBOSE:     Set $item.Organization = ''
VERBOSE:     Set $item.LastUpdatedDate = ''
VERBOSE:     Set $item.ItemComment = ''
VERBOSE: For Task 'タスク7 (ITEM_A1_1配下): 属性フィールド数過剰 (エラーケース、15フィールドの意図)、開始日と終了日入力', AttributeString from HTML comment: 'TASK_007_ERR_FIELD_COUNT_MORE,2025-03-22,2025-03-25,,先行,TASK_003,2025-03-23,2025-03-24,20%,作業員F,チームA1,2025-03-22,コメントです,追加フィールド1,追加フィールド2,, --> <!-- 15フィールドにするため末尾にカンマ2つ追加'
VERBOSE:   Populating Task item from attributesObject (UserDefinedId: 'TASK_007_ERR_FIELD_COUNT_MORE')
VERBOSE:     Set $item.UserDefinedId = 'TASK_007_ERR_FIELD_COUNT_MORE'
VERBOSE:     Set $item.StartDateInput = '2025-03-22'
VERBOSE:     Set $item.EndDateInput = '2025-03-25'
VERBOSE:     Set $item.DurationInput = ''
VERBOSE:     Set $item.DependencyType = '先行'
VERBOSE:     Set $item.PredecessorUserDefinedId = 'TASK_003'
VERBOSE:     Set $item.ActualStartDate = '2025-03-23'
VERBOSE:     Set $item.ActualEndDate = '2025-03-24'
VERBOSE:     Set $item.Progress = '20%'
VERBOSE:     Set $item.Assignee = '作業員F'
VERBOSE:     Set $item.Organization = 'チームA1'
VERBOSE:     Set $item.LastUpdatedDate = '2025-03-22'
VERBOSE:     Set $item.ItemComment = 'コメントです,追加フィールド1,追加フィールド2,,--> <!-- 15フィールドにするため末尾にカンマ2つ追加'
VERBOSE: For Task 'タスク8 (ITEM_A1_1配下): 日付フォーマット不正 (エラーケース)', AttributeString from HTML comment: 'TASK_008_ERR_DATE_FORMAT,2025/04/01,2025-04-05,5,,,,,0%,作業員G,チームA1,INVALID_DATE,開始日入力が不正フォーマット'
VERBOSE:   Populating Task item from attributesObject (UserDefinedId: 'TASK_008_ERR_DATE_FORMAT')
VERBOSE:     Set $item.UserDefinedId = 'TASK_008_ERR_DATE_FORMAT'
VERBOSE:     Set $item.StartDateInput = '2025/04/01'
VERBOSE:     Set $item.EndDateInput = '2025-04-05'
VERBOSE:     Set $item.DurationInput = '5'
VERBOSE:     Set $item.DependencyType = ''
VERBOSE:     Set $item.PredecessorUserDefinedId = ''
VERBOSE:     Set $item.ActualStartDate = ''
VERBOSE:     Set $item.ActualEndDate = ''
VERBOSE:     Set $item.Progress = '0%'
VERBOSE:     Set $item.Assignee = '作業員G'
VERBOSE:     Set $item.Organization = 'チームA1'
VERBOSE:     Set $item.LastUpdatedDate = 'INVALID_DATE'
VERBOSE:     Set $item.ItemComment = '開始日入力が不正フォーマット'
VERBOSE: For Task 'タスク9 (ITEM_A1_1配下): 進捗率フォーマット不正 (エラーケース)', AttributeString from HTML comment: 'TASK_009_ERR_PROGRESS_FORMAT,2025-04-10,2025-04-15,5,,,,五十パーセント,,,,進捗率が不正フォーマット'
VERBOSE:   Populating Task item from attributesObject (UserDefinedId: 'TASK_009_ERR_PROGRESS_FORMAT')
VERBOSE:     Set $item.UserDefinedId = 'TASK_009_ERR_PROGRESS_FORMAT'
VERBOSE:     Set $item.StartDateInput = '2025-04-10'
VERBOSE:     Set $item.EndDateInput = '2025-04-15'
VERBOSE:     Set $item.DurationInput = '5'
VERBOSE:     Set $item.DependencyType = ''
VERBOSE:     Set $item.PredecessorUserDefinedId = ''
VERBOSE:     Set $item.ActualStartDate = ''
VERBOSE:     Set $item.ActualEndDate = '五十パーセント'
VERBOSE:     Set $item.Progress = ''
VERBOSE:     Set $item.Assignee = ''
VERBOSE:     Set $item.Organization = ''
VERBOSE:     Set $item.LastUpdatedDate = '進捗率が不正フォーマット'
VERBOSE:     Set $item.ItemComment = ''
VERBOSE: For Task 'タスク11 (ITEM_A1_1配下): 関連タスク種別 "後続"、開始日と日数入力', AttributeString from HTML comment: 'TASK_011_DEPENDENCY_SUCCESSOR,2025-04-20,,5,後続,TASK_003,,,0%,作業員I,チームA1,,TASK_003の後続タスク。終了日(入力)は空。'
VERBOSE:   Populating Task item from attributesObject (UserDefinedId: 'TASK_011_DEPENDENCY_SUCCESSOR')
VERBOSE:     Set $item.UserDefinedId = 'TASK_011_DEPENDENCY_SUCCESSOR'
VERBOSE:     Set $item.StartDateInput = '2025-04-20'
VERBOSE:     Set $item.EndDateInput = ''
VERBOSE:     Set $item.DurationInput = '5'
VERBOSE:     Set $item.DependencyType = '後続'
VERBOSE:     Set $item.PredecessorUserDefinedId = 'TASK_003'
VERBOSE:     Set $item.ActualStartDate = ''
VERBOSE:     Set $item.ActualEndDate = ''
VERBOSE:     Set $item.Progress = '0%'
VERBOSE:     Set $item.Assignee = '作業員I'
VERBOSE:     Set $item.Organization = 'チームA1'
VERBOSE:     Set $item.LastUpdatedDate = ''
VERBOSE:     Set $item.ItemComment = 'TASK_003の後続タスク。終了日(入力)は空。'
VERBOSE: For Task 'タスク12 (ITEM_A1_1配下): ユーザー記述IDに特殊文字とスペース', AttributeString from HTML comment: 'T@SK_!#_12 SPACES,2025-05-01,2025-05-05,5,,,,,0%,作業員J,チームA1,,IDに特殊文字とスペース'
VERBOSE:   Populating Task item from attributesObject (UserDefinedId: 'T@SK_!#_12 SPACES')
VERBOSE:     Set $item.UserDefinedId = 'T@SK_!#_12 SPACES'
VERBOSE:     Set $item.StartDateInput = '2025-05-01'
VERBOSE:     Set $item.EndDateInput = '2025-05-05'
VERBOSE:     Set $item.DurationInput = '5'
VERBOSE:     Set $item.DependencyType = ''
VERBOSE:     Set $item.PredecessorUserDefinedId = ''
VERBOSE:     Set $item.ActualStartDate = ''
VERBOSE:     Set $item.ActualEndDate = ''
VERBOSE:     Set $item.Progress = '0%'
VERBOSE:     Set $item.Assignee = '作業員J'
VERBOSE:     Set $item.Organization = 'チームA1'
VERBOSE:     Set $item.LastUpdatedDate = ''
VERBOSE:     Set $item.ItemComment = 'IDに特殊文字とスペース'
VERBOSE: For Task 'タスク13 (ITEM_A1_1配下): 長いコメント、開始日と終了日入力', AttributeString from HTML comment: 'TASK_013_LONG_COMMENT,2025-05-10,2025-05-15,,,,,,0%,作業員K,チームA1,,これは非常に長いコメントです。改行は含められませんが、カンマや句読点、英数字、記号などをたくさん含めることができます。テストのために、できるだけ多くの文字数を記述してみます。１２３４５６７８９０ＡＢＣＤＥＦＧＨＩＪＫＬＭＮＯＰＱＲＳＴＵＶＷＸＹＺ。日数(入力)は空。'
VERBOSE:   Populating Task item from attributesObject (UserDefinedId: 'TASK_013_LONG_COMMENT')
VERBOSE:     Set $item.UserDefinedId = 'TASK_013_LONG_COMMENT'
VERBOSE:     Set $item.StartDateInput = '2025-05-10'
VERBOSE:     Set $item.EndDateInput = '2025-05-15'
VERBOSE:     Set $item.DurationInput = ''
VERBOSE:     Set $item.DependencyType = ''
VERBOSE:     Set $item.PredecessorUserDefinedId = ''
VERBOSE:     Set $item.ActualStartDate = ''
VERBOSE:     Set $item.ActualEndDate = ''
VERBOSE:     Set $item.Progress = '0%'
VERBOSE:     Set $item.Assignee = '作業員K'
VERBOSE:     Set $item.Organization = 'チームA1'
VERBOSE:     Set $item.LastUpdatedDate = ''
VERBOSE:     Set $item.ItemComment = 'これは非常に長いコメントです。改行は含められませんが、カンマや句読点、英数字、記号などをたくさん含めることができます。テストのために、できるだけ多くの文字数を記述してみます。１２３４５６７８９０ＡＢＣＤＥＦＧＨＩＪＫＬＭＮＯＰＱＲＳＴＵＶＷＸＹＺ。日数(入力)は空。'
VERBOSE: For Task 'タスク14 (ITEM_A1_1配下): 属性が全て空（ユーザー記述ID以外）', AttributeString from HTML comment: 'TASK_014_ALL_ATTRIBUTES_EMPTY,,,,,,,,,,,,'
VERBOSE:   Populating Task item from attributesObject (UserDefinedId: 'TASK_014_ALL_ATTRIBUTES_EMPTY')
VERBOSE:     Set $item.UserDefinedId = 'TASK_014_ALL_ATTRIBUTES_EMPTY'
VERBOSE:     Set $item.StartDateInput = ''
VERBOSE:     Set $item.EndDateInput = ''
VERBOSE:     Set $item.DurationInput = ''
VERBOSE:     Set $item.DependencyType = ''
VERBOSE:     Set $item.PredecessorUserDefinedId = ''
VERBOSE:     Set $item.ActualStartDate = ''
VERBOSE:     Set $item.ActualEndDate = ''
VERBOSE:     Set $item.Progress = ''
VERBOSE:     Set $item.Assignee = ''
VERBOSE:     Set $item.Organization = ''
VERBOSE:     Set $item.LastUpdatedDate = ''
VERBOSE:     Set $item.ItemComment = ''
VERBOSE: Resolving dependencies...
WARNING: Predecessor task with UserDefinedId 'ROOT_TASK' not found for item 'PROJ_X_FULL' (TaskName: ).
WARNING: Predecessor task with UserDefinedId 'PRE_TASK_DUMMY_NON_EXISTENT' not found for item 'TASK_001_ERR_PREDECESSOR' (TaskName: タスク1 (ITEM_A1_1配下): 全属性、コメントにカンマ、開始日と日数入力).
WARNING: Predecessor task with UserDefinedId 'NON_EXISTENT_TASK_ID' not found for item 'TASK_004_ERR_PREDECESSOR_NOT_FOUND' (TaskName: タスク4 (ITEM_A1_1配下): 先行タスクID不正 (エラーケース)、日数と終了日入力).
WBS data exported to: .\tests\outputs\mdwbs_to_csv\sample_project_B_output.csv
VERBOSE: Finished script Convert-SimpleMdWbsToCsv.ps1
PS C:\Temp\MD-WBS-Tools> 